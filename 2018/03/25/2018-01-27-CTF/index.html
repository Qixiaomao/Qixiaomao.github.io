<html><head></head><body><h1 id="ONCE-MORE-of-write-up"><a href="#ONCE-MORE-of-write-up" class="headerlink" title="ONCE MORE of write up"></a>ONCE MORE of write up</h1><pre><code>write up:
1&gt;&#x9898;&#x76EE;url
2&gt;&#x521D;&#x6B65;&#x68C0;&#x6D4B;
3&gt;&#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;
4&gt;&#x5206;&#x6790;&#x4EE3;&#x7801;&#x6784;&#x9020;&#x8BED;&#x53E5;
</code></pre><h3 id="gt-1-&#x9898;&#x76EE;&#xFF1A;-http-ctf5-shiyanbar-com-web-more-php"><a href="#gt-1-&#x9898;&#x76EE;&#xFF1A;-http-ctf5-shiyanbar-com-web-more-php" class="headerlink" title="&gt;1 &#x9898;&#x76EE;&#xFF1A;  http://ctf5.shiyanbar.com/web/more.php "></a>&gt;1 &#x9898;&#x76EE;&#xFF1A; <a href="http://ctf5.shiyanbar.com/web/more.php" title="(Once more)" target="_blank" rel="noopener"> http://ctf5.shiyanbar.com/web/more.php </a></h3><p>  &#x9996;&#x5148;&#xFF0C;&#x770B;&#x770B;&#x9898;&#x76EE;&#x6709;&#x4EC0;&#x4E48;&#x63D0;&#x793A;&#xFF0C;&#x5982;&#x56FE;&#xFF1A;</p>
<p>  <img src="https://i.imgur.com/HzvVac9.png" alt="(&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;)"> </p>
<h3 id="gt-2-&#x521D;&#x6B65;&#x68C0;&#x6D4B;"><a href="#gt-2-&#x521D;&#x6B65;&#x68C0;&#x6D4B;" class="headerlink" title="&gt;2 &#x521D;&#x6B65;&#x68C0;&#x6D4B;"></a>&gt;2 &#x521D;&#x6B65;&#x68C0;&#x6D4B;</h3><p>  &#x53EF;&#x4EE5;&#x770B;&#x5230;&#x63D0;&#x793A;&#x4E86;ereg()&#x51FD;&#x6570;&#x6709;&#x6F0F;&#x6D1E;&#xFF0C;&#x8FD8;&#x6709;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x79D1;&#x5B66;&#x7684;&#x65B9;&#x6CD5;&#x6765;&#x7B97;&#x6570;&#xFF1B;&#x5148;mark&#x7740;&#xFF1B;<br>  &#x5728;password&#x91CC;&#x8F93;&#x5165;&#x4E86;111&#x6765;&#x68C0;&#x6D4B;</p>
<p>  <img src="https://i.imgur.com/xy2jela.png" alt="&#xFF08;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;2&#xFF09;">  </p>
<p>  &#x8F93;&#x5165;&#x5B8C;&#x4E4B;&#x540E;</p>
<p>  <img src="https://i.imgur.com/QRIvUrY.png" alt="&#xFF08;&#x4EE3;&#x7801;&#x5BA1;&#x8BA1;3&#xFF09;"></p>
<h3 id="gt-3-&#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;"><a href="#gt-3-&#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;" class="headerlink" title="&gt;3 &#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;"></a>&gt;3 &#x67E5;&#x770B;&#x6E90;&#x4EE3;&#x7801;</h3><p>  &#x8FD9;&#x65F6;&#x5019;&#x770B;&#x5230; <strong>view the source code</strong> &#x53EF;&#x4EE5;&#x70B9;&#x5F00;&#x6253;&#x5F00;&#x6E90;&#x7801;&#x8FDB;&#x884C;&#x67E5;&#x770B;<br>  &#x8D34;&#x4E0A;&#x6E90;&#x4EE3;&#x7801;&#xFF1A;</p>
<pre><code>&lt;?php
 if (isset ($_GET[&apos;password&apos;])) {
 if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&apos;password&apos;]) === FALSE)
 {
     echo &apos;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&apos;;
 }
 else if (strlen($_GET[&apos;password&apos;]) &lt; 8 &amp;&amp; $_GET[&apos;password&apos;] &gt; 9999999)
 {
     if (strpos ($_GET[&apos;password&apos;], &apos;*-*&apos;) !== FALSE)
     {
         die(&apos;Flag: &apos; . $flag);
     }
     else
     {
         echo(&apos;&lt;p&gt;*-* have not been found&lt;/p&gt;&apos;);
     }
 }
 else
 {
     echo &apos;&lt;p&gt;Invalid password&lt;/p&gt;&apos;;
 }
}
?&gt;
</code></pre><h3 id="gt-4-&#x5206;&#x6790;&#x4EE3;&#x7801;&#x6784;&#x9020;&#x8BED;&#x53E5;"><a href="#gt-4-&#x5206;&#x6790;&#x4EE3;&#x7801;&#x6784;&#x9020;&#x8BED;&#x53E5;" class="headerlink" title="&gt;4 &#x5206;&#x6790;&#x4EE3;&#x7801;&#x6784;&#x9020;&#x8BED;&#x53E5;"></a>&gt;4 &#x5206;&#x6790;&#x4EE3;&#x7801;&#x6784;&#x9020;&#x8BED;&#x53E5;</h3><p>   &#x9996;&#x5148;&#xFF0C;&#x5728;ereg()&#x51FD;&#x6570;&#x91CC;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#xFF1A;1.&#x5B57;&#x6BCD;&#x5927;&#x5C0F;&#x5199;&#x548C;&#x6570;&#x5B57;&#xFF0C;2.&#x987B;&#x662F;password&#x91CC;&#x7684;&#xFF1B;&#x8FD9;&#x65F6;&#x5019;&#x76F4;&#x63A5;&#x8DF3;&#x5230;&#x4E0B;&#x4E00;&#x4E2A;&#x5224;&#x65AD;&#x8BED;&#x53E5;&#xFF0C;&#xFF08;strlen($_GET[&#x2018;password&#x2019;]&#xFF09;&#x8FD9;&#x91CC;&#x63D0;&#x793A;&#x4E86;&#x5B57;&#x7B26;&#x957F;&#x5EA6;&#x5FC5;&#x987B;&#x5C0F;&#x4E8E;8&#xFF0C;&#x4E14;&#x8981;&#x6C42;&#x5927;&#x4E8E;9999999&#xFF08;$_GET[&#x2018;password&#x2019;] &gt; 9999999&#xFF09;&#x90A3;&#x4E48;&#xFF0C;&#x4E4B;&#x524D;&#x63D0;&#x793A;&#x7684;&#x662F;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x6CD5;&#xFF0C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x4F7F;&#x7528;&#x3002;&#x56E0;&#x4E3A;&#x79D1;&#x5B66;&#x8BA1;&#x7B97;&#x6CD5;&#x91CC;e&#x76F8;&#x5F53;&#x4E8E;10&#xFF0C;&#x53C8;&#x8981;&#x5927;&#x4E8E;&#x4E00;&#x5B9A;&#x7684;&#x6570;&#x503C;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;1.88e3 = 1880;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8FD9;&#x4E48;&#x6784;&#x9020;&#xFF0C;<br>   3e9&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4E86;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x4E14;&#x6EE1;&#x8DB3;&#x4E86;&#x5927;&#x4E8E;9999999&#xFF0C;&#x4F46;&#x662F;&#x5728;strpos()&#x8FD9;&#x4E2A;&#x51FD;&#x6570;&#x91CC;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#x8FD9;&#x91CC;&#x8FD8;&#x6709;&#x4E2A;&#x5224;&#x65AD;&#x6761;&#x4EF6;&#xFF0C;&#x5C31;&#x662F; &#x201C; *-* &#x201D; &#xFF0C;&#x65E2;&#x8981;&#x6EE1;&#x8DB3;&#x4E4B;&#x524D;&#x7684;ereg()&#x91CC;&#x7684;&#x53EA;&#x5E26;&#x6570;&#x5B57;&#x548C;&#x5927;&#x5C0F;&#x5199;&#x5B57;&#x6BCD;&#xFF0C;&#x53C8;&#x8981;&#x6EE1;&#x8DB3;&#x5C0F;&#x4E8E;8&#x4E2A;&#x5B57;&#x8282;&#x7684;&#x5927;&#x4E8E;9999999&#x7684;&#x8BED;&#x53E5;&#xFF0C;&#x600E;&#x4E48;&#x505A;&#x5230;&#x5462;&#xFF1F;</p>
<p>   &#x5728;&#x6CA1;&#x6709;&#x601D;&#x8DEF;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x6211;&#x4EEC;&#x5728;&#x770B;&#x770B;&#x4E4B;&#x524D;&#x7684;&#x63D0;&#x793A;&#xFF0C;&#x6709;&#x4E00;&#x4E2A;&#x5C31;&#x662F;ereg()&#x6F0F;&#x6D1E;&#xFF0C;bing&#x4E86;&#x4E00;&#x901A;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x53D1;&#x73B0;&#xFF0C;ereg()&#x7684;&#x6F0F;&#x6D1E;&#x53EF;&#x4EE5;&#x5229;&#x7528;%00&#x6765;&#x7EC8;&#x7ED3;&#x5224;&#x65AD;&#xFF0C;&#x4ECE;&#x800C;&#x8BE5;&#x8BED;&#x53E5;&#x5C31;&#x662F;&#x201C;3e9%00*-<em>&#x201D; &#x8FD9;&#x53E5;&#x8BED;&#x53E5;&#x7684;&#x610F;&#x601D;&#x5C31;&#x662F;&#x7EC8;&#x6B62;&#x5BF9; \</em>-* &#x4E4B;&#x524D;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7ED5;&#x8FC7;ereg()&#x51FD;&#x6570;&#x5BF9;password&#x6574;&#x53E5;&#x7684;&#x5224;&#x65AD;&#xFF0C;&#x4ECE;&#x800C;&#x5B8C;&#x6210;&#x4E86;&#x5BF9;&#x8BED;&#x53E5;&#x7684;&#x6784;&#x9020;&#x3002;</p>
<p>  <strong>TIS</strong>&#xFF1A;&#x6700;&#x540E;&#x8FD8;&#x6709;&#x4E2A;&#x5BF9;&#x4E8E;&#x5C0F;&#x767D;&#x6765;&#x8BF4;&#x7684;&#x4E00;&#x4E2A;&#x9677;&#x9631;&#xFF0C;&#x5C31;&#x662F;&#x5728;&#x8BE5;&#x9875;&#x9762;&#x63D0;&#x4EA4;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x56E0;&#x4E3A;&#x662F;get&#x65B9;&#x6CD5;&#x63D0;&#x4EA4;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x524D;&#x7AEF;&#x4F1A;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x4E00;&#x4E2A;url&#x7F16;&#x7801;&#xFF0C;&#x90A3;&#x4E48;&#xFF0C;&#x8BE5;&#x6570;&#x636E;&#x4F1A;&#x88AB;&#x8FDB;&#x884C;&#x8F6C;&#x4E49;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x4E0D;&#x901A;&#x8FC7;&#x9875;&#x9762;&#x524D;&#x7AEF;&#x8FDB;&#x884C;&#x63D0;&#x4EA4;&#xFF0C;&#x53EF;&#x4EE5;&#x5728;URL&#x4E0A;&#x8FDB;&#x884C;&#x7F16;&#x5199;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;bp&#x7ED5;&#x8FC7;&#x6D4F;&#x89C8;&#x5668;&#x76F4;&#x63A5;&#x63D0;&#x4EA4;&#x7ED9;&#x670D;&#x52A1;&#x7AEF;&#x3002;</p>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":"hijiki","bottom":-30,"position":"left","mobileShow":false});</script></body></html>